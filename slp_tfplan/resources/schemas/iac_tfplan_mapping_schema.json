{
   "$schema":"http://json-schema.org/draft-06/schema#",
   "title":"Terraform Plan Mapping File Schema",
   "type":"object",
   "additionalProperties":false,
   "properties":{
      "trustzones":{
         "type":"array",
         "items":{
            "$ref":"#/definitions/Trustzone"
         }
      },
      "components":{
         "type":"array",
         "items":{
            "$ref":"#/definitions/Component"
         }
      },
      "configuration":{
         "$ref":"#/definitions/Configuration"
      }
   },
   "required":[

   ],
   "definitions":{
      "Trustzone":{
         "type":"object",
         "additionalProperties":false,
         "properties":{
            "type":{
               "type":"string"
            },
            "name":{
               "type":"string"
            },
            "risk":{
               "$ref":"#/definitions/Risk"
            },
            "$default":{
               "type":"boolean"
            }
         },
         "required":[
            "name",
            "type"
         ],
         "title":"Trustzone"
      },
      "Component":{
         "type":"object",
         "additionalProperties":false,
         "properties":{
            "label":{
               "$ref":"#/definitions/LabelUnion"
            },
            "type":{
               "type":"string"
            },
            "$singleton":{
               "type":"boolean"
            },
            "$category":{
               "type":"string"
            }
         },
         "required":[
            "label",
            "type"
         ],
         "title":"Component"
      },
      "Configuration":{
         "type":"object",
         "additionalProperties":false,
         "properties":{
            "attack_surface":{
               "$ref":"#/definitions/AttackSurface"
            },
            "skip":{
               "type":"array",
               "items":{
                  "type":"string"
               }
            },
            "catch_all":{
              "anyOf": [
                {
                  "type":"string"
                },
                {
                  "type":"boolean"
                }
              ]
            }
         },
         "required":[

         ],
         "title":"Configuration"
      },
      "AttackSurface":{
         "type":"object",
         "additionalProperties":false,
         "properties":{
            "client":{
               "type":"string"
            },
            "trustzone":{
               "type":"string"
            }
         },
         "required":[
            "client",
            "trustzone"
         ],
         "title":"AttackSurface"
      },
      "Risk":{
         "type":"object",
         "additionalProperties":false,
         "properties":{
            "trust_rating":{
               "type":"integer"
            }
         },
         "required":[
            "trust_rating"
         ],
         "title":"Risk"
      },
      "LabelUnion":{
         "anyOf":[
            {
               "type":"array",
               "items":{
                  "type":"string"
               }
            },
            {
               "$ref":"#/definitions/RegExClass"
            },
            {
               "type":"string"
            }
         ],
         "title":"LabelUnion"
      },
      "RegExClass":{
         "type":"object",
         "additionalProperties":false,
         "properties":{
            "$regex":{
               "type":"string"
            }
         },
         "required":[
            "$regex"
         ],
         "title":"RegExClass"
      }
   }
}